# Erro #133010 - Account not registered

## O que significa?
A Business Account no Meta Business Manager não está registrada/autorizada para enviar mensagens via WhatsApp Business API.

## Checklist de Resolução

### 1. Verificar Business Account no Business Manager
- [ ] Abra https://business.facebook.com
- [ ] Vá para **Business Settings** → **Accounts** → **WhatsApp Accounts**
- [ ] Confirme que sua Business Account aparece na lista
- [ ] Verifique o status (deve estar **ACTIVE** ou **ACTIVE_WITHOUT_INSTAGRAM**)

### 2. Verificar Phone Number
- [ ] Em **WhatsApp Accounts**, clique na sua Business Account
- [ ] Vá para **Phone Numbers**
- [ ] Confirme que seu número está vinculado e **VERIFIED**
- [ ] Verifique que o status é **ACTIVE**

### 3. Verificar Webhook Configuration
- [ ] Vá para **Configuration** da sua Business Account
- [ ] Confira o **Webhook URL** está correto:
  ```
  https://waclient-puce.vercel.app/api/webhook
  ```
- [ ] O Webhook deve estar **VERIFIED** ✅

### 4. Completar Account Registration (Importante!)
- [ ] Na aba **Account**, procure por **Account Registration** ou **Account Setup**
- [ ] Se houver um banner azul "Complete account registration", clique em **Complete**
- [ ] Preencha os dados solicitados:
  - **Business Type**: Selecione o tipo de negócio
  - **Business Category**: Selecione a categoria
  - **Business Description**: Descreva sua empresa/uso
  - **Website/Address**: Forneça informações de contato
- [ ] Clique em **Submit** para enviar para análise
- [ ] Pode levar até 24 horas para aprovação

### 5. Verificar Permissões de Token
- [ ] Seu token deve ter as permissões:
  - `whatsapp_business_management`
  - `whatsapp_business_messaging`
  - `business_management`

- [ ] Para gerar um novo token:
  1. Vá para https://developers.facebook.com/
  2. Selecione seu App
  3. **Tools** → **Access Token**
  4. Selecione sua Business Account
  5. Copie o token gerado
  6. Atualize em `.env` → `WHATSAPP_ACCESS_TOKEN`

### 6. Testar Webhook
- [ ] Abra https://waclient-puce.vercel.app/api/debug
- [ ] Verifique se ambos os testes passam:
  - ✅ Phone Number test OK
  - ✅ Business Account test OK
  - (Message test ainda pode falhar se conta não aprovada)

## Possíveis Causas

| Causa | Solução |
|-------|---------|
| Account Registration incompleto | Complete o passo 4 acima |
| Phone Number não verificado | Verifique o número no Business Manager |
| Webhook não confirmado | Reconfirme o webhook |
| Token expirado | Gere um novo token (passo 5) |
| Account ID inválido | Copie o ID correto do Business Manager |
| Phone Number ID inválido | Copie o ID correto do Business Manager |

## Próximos Passos

1. **Primeiro**: Complete a Account Registration (passo 4)
2. **Depois**: Aguarde 24h para aprovação
3. **Então**: Teste novamente no `/api/debug`
4. **Por fim**: Se ainda não funcionar, contate suporte Meta

## Recursos Úteis

- [Meta WhatsApp Business Account Setup](https://developers.facebook.com/docs/whatsapp/cloud-api/get-started)
- [Troubleshooting Common Errors](https://developers.facebook.com/docs/whatsapp/cloud-api/troubleshooting/common-issues)
- [Account Registration Guide](https://www.whatsapp.com/business/api)

## Debug Info Útil

Quando contactar suporte, forneça:
- fbtrace_id: `AsRiENlHPdIvlG6Wjv0LQRi`
- Error code: `133010`
- Output de https://waclient-puce.vercel.app/api/debug
- Screenshot do Business Manager mostrando status da conta
